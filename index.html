<html>
<head>

<script type='text/javascript' src='js/knockout-2.2.1.js'></script>
<script src="http://vk.com/js/api/openapi.js" type="text/javascript"></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>

<link type="text/css" rel="stylesheet" href="css/main.css">

</head>
<body>
<div id="login_button" data-bind="click: vkLogin"></div>
<script language="javascript">

	VK.init({
		apiId: 3704235
	});


	function authInfo(response) {
		if (response.session) {

		} else {
			alert('not auth');
		}
	}
	VK.Auth.getLoginStatus(authInfo);
	VK.UI.button('login_button');

	/*$(window).scroll(function () {
		var doc = $(document).height();
		var win  = $(window).height();
		var diff = $(document).height() - $(window).height();

		var el = document.getElementById('show_more');
		var pos = el.offsetTop;
		var cur_pos = $(window).scrollTop();
		if (parseInt($(window).scrollTop()) + 600 >=  pos) {
			GirlFriendsViewModel.getMoreFriends();
		}
	})*/
</script>
	<div data-bind="visible: errors().length > 0, foreach: errors">
		<div class="error">
			Error code: <span data-bind="text: code"></span>
			Error message:<span data-bind="text: message"></span>
		</div>
	</div>

	<div class="friends" data-bind="foreach: friends, event: {scroll: getMoreFriends}">
		<div class="people_row">
			<div class="img">
				<a data-bind="attr:{href: 'http://vk.com/id' + uid}" target="_blank">
					<img data-bind="attr:{src: photo}" />
				</a>
			</div>

			<div class="info">
				<div data-bind="text: first_name"></div>
				<div data-bind="text: last_name"></div>
				<div data-bind="text: relation"></div>
				Friend of:
				<a data-bind="attr:{href: friendOfUrl()}" target="_blank">
					<span data-bind="text: friendOf()"></span>
				</a>
			</div>
		</div>
	</div>
	<div id="show_more" style="position: relative; clear: both; float: left;">


	</div>

	<div class="statistic">
		<h3 class="total">Total friends: <span data-bind="text: total_friends()"></span></h3>

		<h3 class="total" data-bind="foreach: friend_ids">Total friends of:
			<span data-bind="text: total_friends_of()"></span>
		</h3>
		<button class="more-friends" data-bind="click: getMoreFriends">Get more friends</button>
	</div>

<script type='text/javascript' src='js/GirlFriendsModel.js'></script>

</body>
</html>